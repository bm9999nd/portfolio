import{R as u,V as g,d as p,g as d,ma as h,mc as f}from"./chunk-XSK66XXE.js";var b=(()=>{let n=class n{constructor(t){this.navigator=t,this.eventOnInit=new h,this.eventSignedIn=new h,this.inited={gapi:!1,gis:!1},t.importTag({type:"script",src:"https://apis.google.com/js/api.js",onload:()=>this.onImport("gapi")}),t.importTag({type:"script",src:"https://accounts.google.com/gsi/client",onload:()=>this.onImport("gis")})}get enabled(){return this.inited.gapi&&this.inited.gis}set auth(t){this._auth=t,typeof gapi<"u"&&t.apiKey!=""&&this.onloadGapi(t),typeof google<"u"&&t.clientId!=""&&this.onloadGis(t)}onImport(t){let e=this._auth;if(!(typeof e>"u"))switch(t){case"gapi":this.onloadGapi(e);break;case"gis":this.onloadGis(e);break}}onloadGapi(t){let e=()=>this.initializeGapiClient(t);try{gapi.load("client",e)}catch(i){console.log(i)}}initializeGapiClient(t){return p(this,null,function*(){yield gapi.client.init({apiKey:t.apiKey,discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"]}),this.inited.gapi=!0,this.onLoaded()})}onloadGis(t){let e=["https://www.googleapis.com/auth/spreadsheets.readonly","https://www.googleapis.com/auth/spreadsheets"];try{this.tokenClient=google.accounts.oauth2.initTokenClient({client_id:t.clientId,scope:e.join(" "),callback:""}),this.inited.gis=!0,this.onLoaded()}catch(i){console.log(i)}}onLoaded(){this.eventOnInit.emit(this.inited)}signIn(){if(!this.enabled){console.warn("Script not loaded yet!");return}this.tokenClient.callback=t=>p(this,null,function*(){if(t.error!==void 0)throw this.eventSignedIn.emit({status:!1,result:t.error}),t;let e={access_token:t.access_token,expires_in:t.expires_in,token_type:t.token_type,scope:t.scope.split(" ")};this.eventSignedIn.emit({status:!0,result:e})}),this.tokenClient.requestAccessToken({prompt:""})}signOut(){let t=gapi.client.getToken();t!==null&&(google.accounts.oauth2.revoke(t.access_token),gapi.client.setToken(""))}getBatch(t,e){return new d(i=>{gapi.client.sheets.spreadsheets.values.batchGet({spreadsheetId:t,dateTimeRenderOption:"FORMATTED_STRING",valueRenderOption:"UNFORMATTED_VALUE",ranges:e}).then(s=>{i.next(s.result),i.complete()}).catch(s=>{i.error(s)})})}stringToList(t,e="	"){let i=t.split(`\r
`),s=[];return i.forEach(o=>{let r=[];o.split(e).forEach(a=>{let l=a.trim()!=""&&!isNaN(Number(a));r.push(l?Number(a):a)}),s.push(r)}),s}listToObject(t){let e=[];t[0].forEach(s=>{let o=s.replace(/\s/g,"");e.push(o)});let i=[];return t.forEach((s,o)=>{if(o==0)return;let r={id:o};s.forEach((a,l)=>{r[e[l]]=a}),i.push(r)}),i}};n.\u0275fac=function(e){return new(e||n)(g(f))},n.\u0275prov=u({token:n,factory:n.\u0275fac,providedIn:"root"});let c=n;return c})();export{b as a};
