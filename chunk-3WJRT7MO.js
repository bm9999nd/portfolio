import{t as W}from"./chunk-B66WOW4P.js";import"./chunk-4MNFZP5U.js";import{$a as m,Cb as P,Eb as h,Fb as M,Ib as z,Kb as B,Lb as O,Ma as u,Na as v,T as w,Ub as L,Y as G,Za as C,aa as A,d as b,db as s,eb as r,ec as U,fb as V,fc as q,g as S,gb as D,gc as $,hb as N,ia as f,ib as k,ja as _,jb as j,kb as y,kc as Y,lb as R,mc as H,nc as J,oa as F,pa as T,sc as Q,tb as E,ub as l,vb as K,wb as x}from"./chunk-FTRD6JFR.js";var X=(()=>{let o=class o{constructor(e){this.navigator=e,this.eventOnInit=new T,this.eventSignedIn=new T,this.inited={gapi:!1,gis:!1},e.importTag({type:"script",src:"https://apis.google.com/js/api.js",onload:()=>this.onImport("gapi")}),e.importTag({type:"script",src:"https://accounts.google.com/gsi/client",onload:()=>this.onImport("gis")})}get enabled(){return this.inited.gapi&&this.inited.gis}set auth(e){this._auth=e,typeof gapi<"u"&&e.apiKey!=""&&this.onloadGapi(e),typeof google<"u"&&e.clientId!=""&&this.onloadGis(e)}onImport(e){let n=this._auth;if(!(typeof n>"u"))switch(e){case"gapi":this.onloadGapi(n);break;case"gis":this.onloadGis(n);break}}onloadGapi(e){let n=()=>this.initializeGapiClient(e);try{gapi.load("client",n)}catch(i){console.log(i)}}initializeGapiClient(e){return b(this,null,function*(){yield gapi.client.init({apiKey:e.apiKey,discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"]}),this.inited.gapi=!0,this.onLoaded()})}onloadGis(e){let n=["https://www.googleapis.com/auth/spreadsheets.readonly","https://www.googleapis.com/auth/spreadsheets"];try{this.tokenClient=google.accounts.oauth2.initTokenClient({client_id:e.clientId,scope:n.join(" "),callback:""}),this.inited.gis=!0,this.onLoaded()}catch(i){console.log(i)}}onLoaded(){this.eventOnInit.emit(this.inited)}signIn(){if(!this.enabled){console.warn("Script not loaded yet!");return}this.tokenClient.callback=e=>b(this,null,function*(){if(e.error!==void 0)throw this.eventSignedIn.emit({status:!1,result:e.error}),e;let n={access_token:e.access_token,expires_in:e.expires_in,token_type:e.token_type,scope:e.scope.split(" ")};this.eventSignedIn.emit({status:!0,result:n})}),this.tokenClient.requestAccessToken({prompt:""})}signOut(){let e=gapi.client.getToken();e!==null&&(google.accounts.oauth2.revoke(e.access_token),gapi.client.setToken(""))}getBatch(e,n){return new S(i=>{gapi.client.sheets.spreadsheets.values.batchGet({spreadsheetId:e,dateTimeRenderOption:"FORMATTED_STRING",valueRenderOption:"UNFORMATTED_VALUE",ranges:n}).then(a=>{i.next(a.result),i.complete()}).catch(a=>{i.error(a)})})}stringToList(e,n="	"){let i=e.split(`\r
`),a=[];return i.forEach(d=>{let c=[];d.split(n).forEach(g=>{let I=g.trim()!=""&&!isNaN(Number(g));c.push(I?Number(g):g)}),a.push(c)}),a}listToObject(e){let n=[];e[0].forEach(a=>{let d=a.replace(/\s/g,"");n.push(d)});let i=[];return e.forEach((a,d)=>{if(d==0)return;let c={id:d};a.forEach((g,I)=>{c[n[I]]=g}),i.push(c)}),i}};o.\u0275fac=function(n){return new(n||o)(G(Q))},o.\u0275prov=w({token:o,factory:o.\u0275fac,providedIn:"root"});let t=o;return t})();var Z=t=>({bool:t}),te=t=>({disabled:t}),ie=t=>({name:"Bearer",value:t}),ne=t=>({name:"Access tk",value:t}),oe=t=>({name:"Expires",value:t}),ae=(t,o)=>({"bi-check text-success":t,"bi-x text-danger":o});function se(t,o){if(t&1&&(D(0),s(1,"li",22),l(2),r(),N()),t&2){let p=o.$implicit;u(2),x(" ",p," ")}}function re(t,o){if(t&1&&(s(0,"section",17)(1,"h2"),l(2,"Result :"),r(),s(3,"div"),k(4,9)(5,9)(6,9),z(7,"number"),s(8,"div",5)(9,"div",18),l(10," Scopes: "),r(),s(11,"ul"),C(12,se,3,1,"ng-container",19),r()()(),s(13,"div",20)(14,"a",21),l(15," Continue "),r()()()),t&2){let p=R(),e=E(30);u(4),m("ngTemplateOutlet",e)("ngTemplateOutletContext",h(12,ie,p.tk.token_type)),u(),m("ngTemplateOutlet",e)("ngTemplateOutletContext",h(14,ne,p.tk.access_token)),u(),m("ngTemplateOutlet",e)("ngTemplateOutletContext",h(16,oe,B(7,8,p.tk.expires_in,"1.0","id-ID")+" seconds")),u(6),m("ngForOf",p.tk.scope)("ngForTrackBy",p.app.tracker)}}function le(t,o){if(t&1&&(s(0,"div",5)(1,"div",18),l(2),r(),s(3,"div",23),l(4),r()()),t&2){let p=o.name,e=o.value;u(2),x("",p," :"),u(2),K(e)}}function ce(t,o){if(t&1&&V(0,"i",24),t&2){let p=o.bool;m("ngClass",M(1,ae,p,!p))}}var ke=(()=>{let o=class o{constructor(e,n,i,a){this.el=e,this.app=n,this.gs=i,this.cd=a,this.auth={apiKey:"",clientId:"",useOauth:!1},this.plugin={gapi:!1,gis:!1}}ngOnInit(){this.onEvents()}onEvents(){this.gs.eventOnInit.subscribe(e=>{this.plugin.gapi=e.gapi,e.gis&&setTimeout(()=>{this.gs.signIn()},100),this.cd.detectChanges()}),this.gs.eventSignedIn.subscribe(e=>{this.plugin.gis=e.status,e.status&&(this.tk=e.result),this.cd.detectChanges()})}onAuthorize(e){e.preventDefault(),this.gs.auth={apiKey:this.auth.apiKey,clientId:this.auth.clientId,storageName:"gtoken"}}};o.\u0275fac=function(n){return new(n||o)(v(F),v(W),v(X),v(L))},o.\u0275cmp=A({type:o,selectors:[["app-gsheets"]],standalone:!0,features:[P],decls:33,vars:12,consts:[["tokenResult",""],["check",""],[1,"container"],["href","https://console.cloud.google.com/apis/credentials","rel","noopener","target","_blank","title","Google Cloud APIS Credentials page"],[3,"input"],[1,"mb-3"],["for","api"],[1,"hstack"],["type","text","name","api","id","api","title","API Key","required","","placeholder","Insert Google API Key...",1,"form-control",3,"input"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"form-check"],["type","checkbox","name","oauth2","id","oauth2","title","Enable OAuth2 Mode",1,"form-check-input",3,"input"],["for","oauth2",1,"form-check-label"],["type","text","name","clientid","id","clientid","title","Client ID","placeholder","Insert User Client ID...",1,"form-control",3,"input","ngClass"],[1,"justify-content-center","d-flex"],["type","button","name","connect","id","connect",1,"btn","btn-primary",3,"click"],["class","border rounded p-3 my-3 bg-body-secondary",4,"ngIf"],[1,"border","rounded","p-3","my-3","bg-body-secondary"],[1,"fw-medium"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"text-end"],["href","",1,"btn","btn-primary","disabled"],[1,"text-truncate"],[1,"ms-3","text-truncate"],[1,"bi",3,"ngClass"]],template:function(n,i){if(n&1){let a=j();s(0,"section",2)(1,"h1"),l(2,"API Authorization"),r(),s(3,"article")(4,"p"),l(5,"This section is to test the connection of your API key."),r(),s(6,"p"),l(7," You can create/select your API here : "),s(8,"a",3),l(9," Google Cloud APIS (Credentials) "),r()()(),s(10,"form",4),y("input",function(){return f(a),_(i.tk=void 0)}),s(11,"div",5)(12,"label",6),l(13,"API Key"),r(),s(14,"div",7)(15,"input",8),y("input",function(c){return f(a),_(i.auth.apiKey=i.app.navigator.inputValue(c,"string"))}),r(),k(16,9),r()(),s(17,"div",5)(18,"div",10)(19,"input",11),y("input",function(c){return f(a),_(i.auth.useOauth=i.app.navigator.inputValue(c,"bool"))}),r(),s(20,"label",12),l(21,"Client ID"),r()(),s(22,"div",7)(23,"input",13),y("input",function(c){return f(a),_(i.auth.clientId=i.app.navigator.inputValue(c,"string"))}),r(),k(24,9),r()(),s(25,"div",14)(26,"button",15),y("click",function(c){return f(a),_(i.onAuthorize(c))}),l(27," Connect "),r()()(),C(28,re,16,18,"section",16),r(),C(29,le,5,2,"ng-template",null,0,O)(31,ce,1,4,"ng-template",null,1,O)}if(n&2){let a=E(32);u(16),m("ngTemplateOutlet",a)("ngTemplateOutletContext",h(6,Z,i.plugin.gapi)),u(7),m("ngClass",h(8,te,!i.auth.useOauth)),u(),m("ngTemplateOutlet",a)("ngTemplateOutletContext",h(10,Z,i.plugin.gis)),u(4),m("ngIf",i.tk!=null)}},dependencies:[J,U,q,$,Y,H]});let t=o;return t})();export{ke as GsheetsComponent};
